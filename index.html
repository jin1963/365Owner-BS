<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>365df Owner Dashboard (V3)</title>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script defer src="./config.js"></script>
  <script defer src="./owner.js"></script>

  <style>
    :root{
      --bg:#07070a; --card:#0f1016; --card2:#0b0c11;
      --gold:#d7b35b; --gold2:#b89235; --text:#e9e9f0; --muted:#9aa0b2;
      --line:rgba(255,255,255,.08);
    }
    *{box-sizing:border-box}
    body{margin:0;background:radial-gradient(1200px 800px at 20% -20%, rgba(215,179,91,.18), transparent 55%), var(--bg);
      color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;}
    .wrap{max-width:980px;margin:0 auto;padding:18px}
    .hero{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
    .title h1{margin:0;font-size:26px;letter-spacing:.2px}
    .title .sub{margin:4px 0 0;color:var(--muted);font-size:13px}
    .btn{border:1px solid var(--line); background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.01));
      color:var(--text); padding:10px 14px; border-radius:12px; cursor:pointer}
    .btn.primary{border-color:rgba(215,179,91,.35); background:linear-gradient(180deg, rgba(215,179,91,.25), rgba(215,179,91,.06));
      color:#111; font-weight:700}
    .btn:disabled{opacity:.45; cursor:not-allowed}
    .grid{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:860px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      border:1px solid var(--line); border-radius:16px; padding:14px}
    .card h2{margin:0 0 10px; font-size:16px; color:var(--gold)}
    .row{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:8px 0;border-bottom:1px dashed var(--line)}
    .row:last-child{border-bottom:none}
    .k{color:var(--muted);font-size:13px}
    .v{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; font-size:13px}
    .status{margin-top:10px;color:var(--muted);font-size:13px}
    .actions{display:flex;flex-wrap:wrap; gap:10px; margin-top:10px}
    input{width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--line);
      background:var(--card2); color:var(--text); outline:none}
    label{display:block;color:var(--muted);font-size:12px;margin:10px 0 6px}
    .hint{color:var(--muted);font-size:12px;margin-top:6px}
    .danger{color:#ffb4b4}
  </style>
</head>

<body>
  <div class="wrap">
    <header class="hero">
      <div class="title">
        <h1>365df Owner Dashboard (V3)</h1>
        <div class="sub">BSC Mainnet • Withdraw • Treasury • Balances</div>
      </div>
      <button id="btnConnect" class="btn primary">Connect Wallet</button>
    </header>

    <div class="grid">
      <section class="card">
        <h2>Wallet</h2>
        <div class="row"><div class="k">Address</div><div id="me" class="v">-</div></div>
        <div class="row"><div class="k">Network</div><div id="net" class="v">-</div></div>
        <div class="row"><div class="k">Owner check</div><div id="ownerOk" class="v">-</div></div>
        <div class="row"><div class="k">Core Treasury</div><div id="treasury" class="v">-</div></div>
        <div class="row"><div class="k">Contracts</div><div id="contracts" class="v">-</div></div>
        <div id="status" class="status">Ready.</div>
      </section>

      <section class="card">
        <h2>Balances (On-chain)</h2>
        <div class="row"><div class="k">Vault USDT balance</div><div id="balVaultUSDT" class="v">-</div></div>
        <div class="row"><div class="k">Vault DF balance</div><div id="balVaultDF" class="v">-</div></div>
        <div class="row"><div class="k">Staking DF balance</div><div id="balStakingDF" class="v">-</div></div>
        <div class="row"><div class="k">Vault total claimable USDT</div><div id="totClaimUSDT" class="v">-</div></div>
        <div class="row"><div class="k">Vault total claimable DF</div><div id="totClaimDF" class="v">-</div></div>
        <div class="row"><div class="k">Vault surplus USDT</div><div id="surplusUSDT" class="v">-</div></div>
        <div class="actions">
          <button id="btnRefresh" class="btn">Refresh</button>
        </div>
        <div class="hint">Tip: Vault must be funded with USDT/DF for users to claim. Staking must be funded with DF for rewards.</div>
      </section>

      <section class="card">
        <h2>Withdraw Surplus USDT (Vault)</h2>
        <label>To address</label>
        <input id="wUsdtTo" placeholder="0x..." />
        <label>Amount (USDT)</label>
        <input id="wUsdtAmt" placeholder="e.g. 10" />
        <div class="actions">
          <button id="btnWUsdt" class="btn primary">Withdraw USDT</button>
        </div>
        <div class="hint">Calls: VaultV3.withdrawSurplusUSDT(to, amount). Amount uses 18 decimals (your USDT is 18 decimals).</div>
      </section>

      <section class="card">
        <h2>Withdraw DF (Staking)</h2>
        <label>To address</label>
        <input id="wDfTo" placeholder="0x..." />
        <label>Amount (DF)</label>
        <input id="wDfAmt" placeholder="e.g. 100" />
        <div class="actions">
          <button id="btnWDf" class="btn primary">Withdraw DF</button>
        </div>
        <div class="hint">Calls: StakingV3.ownerWithdrawDF(to, amount).</div>
      </section>

      <section class="card">
        <h2>Set Treasury (Core)</h2>
        <label>New treasury address</label>
        <input id="newTreasury" placeholder="0x..." />
        <div class="actions">
          <button id="btnSetTreasury" class="btn">Set Treasury</button>
        </div>
        <div class="hint danger">Only owner can change treasury. This affects where the 10% fee goes (if your CoreV3 takes fee on buy).</div>
      </section>

      <section class="card">
        <h2>Notes</h2>
        <div class="hint">
          <div>• If buttons do nothing in Bitget: usually the wallet popup is blocked or the button is disabled by owner-check.</div>
          <div>• This Owner DApp will disable actions if your connected wallet is not the on-chain owner.</div>
        </div>
      </section>
    </div>
  </div>
</body>
</html>
